version: "3.5"
name: raopics
services:
  nginx:
    image: nginx:alpine
    ports:
      - 80:80
    command: [nginx, "-g", "daemon off;"]
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro

  api:
    tty: true
    build: ./
    environment:
      LIBRARY: /library # volumes中的地址
      PORT: 9600
    volumes:
      # 本地挂载library地址
      - /Users/qymeet/Pictures/rao.library/images:/library/images:ro
      - /Users/qymeet/Pictures/rao.library/metadata.json:/library/metadata.json:ro
      - /Users/qymeet/Pictures/rao.library/tags.json:/library/tags.json:ro
      # 运行完成后在容器的 library/raopics.db 中会新增一个db文件。你可以将它导出到本地，
      # 放在 `/Users/qymeet/Pictures/rao.library/` 的目录中，然后取消注释。下次执行时就不会再从零开始索引数据。
      # - /Users/qymeet/Pictures/rao.library/raopics.db:/library/raopics.db

  rua:
    image: meetqy/raopics-rua
    environment:
      PORT: 9601
